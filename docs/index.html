
<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Alpaca Paper Dashboard</title>
<style>
  :root {
    --bg: #0b0d10; --card: #111418; --muted: #9aa4ad; --fg: #e6eef5; --border: #222831;
    --pos: #14b86e; --neg: #ff5a5f; --accent: #60a5fa;
  }
  @media (prefers-color-scheme: light) {
    :root {
      --bg:#f7f8fa; --card:#ffffff; --muted:#5b6670; --fg:#0b141a; --border:#dfe5ec;
      --pos:#0a7f4f; --neg:#c03a3e; --accent:#2563eb;
    }
  }
  * { box-sizing: border-box; }
  body { margin:0; background:var(--bg); color:var(--fg); font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial; padding:16px; }
  .container{max-width:1200px;margin:0 auto}
  header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:12px;flex-wrap:wrap}
  h1{font-size:20px;margin:0}
  .muted{color:var(--muted)}
  .grid{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:12px}
  @media (max-width:900px){.grid{grid-template-columns:repeat(2,minmax(0,1fr))}}
  @media (max-width:560px){.grid{grid-template-columns:1fr}}
  .card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:12px}
  .kpi .label{font-size:12px;color:var(--muted);margin-bottom:6px}
  .kpi .value{font-size:22px;font-weight:600}
  .section-title{font-size:16px;margin:14px 0 6px 0}
  .tablewrap{overflow:auto;border:1px solid var(--border);border-radius:12px}
  table{border-collapse:separate;border-spacing:0;width:100%;min-width:680px;background:var(--card)}
  th,td{padding:10px 12px;border-bottom:1px solid var(--border);font-size:14px;text-align:right;white-space:nowrap}
  th:first-child,td:first-child{text-align:left}
  thead th{position:sticky;top:0;background:var(--card);z-index:1}
  tbody tr:hover{background:rgba(96,165,250,.08)}
  .pos{color:var(--pos)} .neg{color:var(--neg)}
  .row{display:grid;grid-template-columns:2fr 1fr;gap:12px}
  @media (max-width:900px){.row{grid-template-columns:1fr}}
  .toolbar{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  select,button{padding:8px 10px;border-radius:10px;border:1px solid var(--border);background:var(--card);color:var(--fg)}
  .foot{margin-top:12px;color:var(--muted);font-size:12px}
  .chartbox{height:320px}
  @media (max-width:560px){.chartbox{height:260px}}
</style>
</head>
<body>
<div class="container">
  <header>
    <div>
      <h1>Alpaca Paper Dashboard</h1>
      <div class="muted">Last update: 2025-09-30T13:52:14Z (UTC)</div>
    </div>
    <div class="toolbar">
      <button id="equityToggle">Equity: Daily</button>
      <label class="muted" for="symSel" style="margin-left:8px">Symbol</label>
      <select id="symSel"></select>
      <button id="toggleMetric">Metric: % P/L</button>
    </div>
  </header>

  <div class="grid">
    <div class="card kpi"><div class="label">Portfolio Value</div><div class="value">$100,588.77</div></div>
    <div class="card kpi"><div class="label">Last Equity (prev close)</div><div class="value">$100,998.42</div></div>
    <div class="card kpi"><div class="label">Cash</div><div class="value">$5.01</div></div>
    <div class="card kpi"><div class="label">Buying Power</div><div class="value">$100,593.78</div></div>
  </div>

  <div class="row">
    <div class="card">
      <div class="section-title">Equity History</div>
      <div class="chartbox"><canvas id="equityChart"></canvas></div>
      <div class="muted" style="font-size:12px;margin-top:6px">Default: Daily (one point per calendar day). Toggle to Intraday.</div>
    </div>
    <div class="card">
      <div class="section-title">Per-Symbol Performance</div>
      <div class="muted" style="font-size:13px;margin-bottom:6px">Switch between % P/L and Price</div>
      <div class="chartbox"><canvas id="symbolChart"></canvas></div>
    </div>
  </div>

  <div class="section-title">Active Trailing Stops</div>
  <div class="tablewrap">
    <table>
      <thead>
        <tr><th>ID</th><th>Symbol</th><th>Qty</th><th>Trail %</th><th>Trail $</th><th>Status</th><th>Submitted</th></tr>
      </thead>
      <tbody>
        <tr><td class='muted'>17b25339-a41e-4827-b2d3-d4ca21d229d6</td><td>CENX</td><td>958.0</td><td>8.0%</td><td></td><td>new</td><td>2025-09-27T23:12:45.303339+00:00</td></tr>
      </tbody>
    </table>
  </div>

  <div class="section-title">Active Fixed Stops</div>
  <div class="tablewrap">
    <table>
      <thead>
        <tr><th>ID</th><th>Symbol</th><th>Qty</th><th>Stop $</th><th>Status</th><th>Submitted</th></tr>
      </thead>
      <tbody>
        <tr><td class='muted'>dbab8d00-8120-4be4-973c-c8cf278c2dd1</td><td>APH</td><td>203.021115893</td><td>$110.82</td><td>new</td><td>2025-09-30T08:00:11.586811+00:00</td></tr><tr><td class='muted'>337f4f85-aee0-4810-b227-aef389ed424b</td><td>EAT</td><td>180.949551244</td><td>$124.34</td><td>new</td><td>2025-09-30T08:00:11.579253+00:00</td></tr><tr><td class='muted'>f2e76a7c-1bd5-4882-91c4-694d13d3e350</td><td>ANIP</td><td>262.987795896</td><td>$85.55</td><td>new</td><td>2025-09-30T08:00:09.577410+00:00</td></tr>
      </tbody>
    </table>
  </div>

  <div class="section-title">Open Orders (All Types)</div>
  <div class="tablewrap">
    <table>
      <thead>
        <tr><th>ID</th><th>Symbol</th><th>Side</th><th>Type</th><th>Qty</th><th>Status</th><th>Submitted</th></tr>
      </thead>
      <tbody>
        <tr><td class='muted'>dbab8d00-8120-4be4-973c-c8cf278c2dd1</td><td>APH</td><td>sell</td><td>stop</td><td>203.021115893</td><td>new</td><td>2025-09-30T08:00:11.586811+00:00</td></tr><tr><td class='muted'>337f4f85-aee0-4810-b227-aef389ed424b</td><td>EAT</td><td>sell</td><td>stop</td><td>180.949551244</td><td>new</td><td>2025-09-30T08:00:11.579253+00:00</td></tr><tr><td class='muted'>f2e76a7c-1bd5-4882-91c4-694d13d3e350</td><td>ANIP</td><td>sell</td><td>stop</td><td>262.987795896</td><td>new</td><td>2025-09-30T08:00:09.577410+00:00</td></tr><tr><td class='muted'>17b25339-a41e-4827-b2d3-d4ca21d229d6</td><td>CENX</td><td>sell</td><td>trailing_stop</td><td>958.0</td><td>new</td><td>2025-09-27T23:12:45.303339+00:00</td></tr>
      </tbody>
    </table>
  </div>

  <div class="section-title">Positions</div>
  <div class="tablewrap">
    <table>
      <thead>
        <tr><th>Symbol</th><th>Qty</th><th>Avg Entry</th><th>Current</th><th>Market Value</th><th>Unreal P/L</th><th>Unreal P/L %</th></tr>
      </thead>
      <tbody>
        <tr><td>ANIP</td><td>262.988</td><td>$95.05</td><td>$92.51</td><td>$24,329.00</td><td class='neg'>$-667.99</td><td class='neg'>-2.67%</td></tr><tr><td>APH</td><td>203.021</td><td>$123.13</td><td>$122.70</td><td>$24,909.68</td><td class='neg'>$-88.31</td><td class='neg'>-0.35%</td></tr><tr><td>CENX</td><td>958.956</td><td>$26.07</td><td>$28.92</td><td>$27,732.99</td><td class='pos'>$2,733.02</td><td class='pos'>10.93%</td></tr><tr><td>EAT</td><td>180.95</td><td>$138.16</td><td>$130.49</td><td>$23,612.09</td><td class='neg'>$-1,387.90</td><td class='neg'>-5.55%</td></tr>
      </tbody>
    </table>
  </div>

  <div class="foot">Data: Alpaca Paper API · Static page updated by GitHub Actions · Mobile-friendly.</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
const equityLabelsIntraday = ["2025-09-27T22:25:04Z", "2025-09-27T22:42:31Z", "2025-09-27T22:48:55Z", "2025-09-27T22:54:02Z", "2025-09-27T23:13:33Z", "2025-09-29T13:22:41Z", "2025-09-29T13:42:54Z", "2025-09-29T13:52:04Z", "2025-09-29T13:58:22Z", "2025-09-29T14:15:58Z", "2025-09-29T14:35:04Z", "2025-09-29T14:45:47Z", "2025-09-29T14:51:51Z", "2025-09-29T14:57:50Z", "2025-09-29T15:14:50Z", "2025-09-29T15:31:35Z", "2025-09-29T15:42:02Z", "2025-09-29T15:48:15Z", "2025-09-29T15:55:15Z", "2025-09-29T16:09:17Z", "2025-09-29T16:29:07Z", "2025-09-29T16:38:10Z", "2025-09-29T16:44:35Z", "2025-09-29T16:50:18Z", "2025-09-29T16:56:35Z", "2025-09-29T17:11:20Z", "2025-09-29T17:28:41Z", "2025-09-29T17:36:34Z", "2025-09-29T17:42:51Z", "2025-09-29T17:49:06Z", "2025-09-29T17:54:41Z", "2025-09-29T18:00:21Z", "2025-09-29T18:29:13Z", "2025-09-29T18:48:08Z", "2025-09-29T18:55:32Z", "2025-09-29T19:07:53Z", "2025-09-29T19:22:52Z", "2025-09-29T19:28:33Z", "2025-09-29T19:36:20Z", "2025-09-29T19:43:07Z", "2025-09-29T19:49:20Z", "2025-09-29T19:55:37Z", "2025-09-29T20:11:07Z", "2025-09-29T20:26:49Z", "2025-09-29T20:35:38Z", "2025-09-29T20:43:07Z", "2025-09-29T20:49:12Z", "2025-09-29T20:54:44Z", "2025-09-29T21:00:12Z", "2025-09-30T13:22:20Z", "2025-09-30T13:42:35Z", "2025-09-30T13:52:14Z"];
const equityValuesIntraday = [100127.3, 100127.3, 100127.3, 100127.3, 100127.3, 101573.5, 101888.73, 101634.23, 101540.83, 100947.02, 101490.77, 101207.92, 101166.0, 101187.03, 100989.65, 101222.26, 101005.52, 101073.63, 100780.75, 100563.16, 100545.53, 100485.98, 100516.15, 100562.12, 100512.98, 100589.73, 100639.29, 100760.47, 100721.79, 100681.58, 100799.03, 100721.06, 100397.09, 100448.19, 100318.82, 100355.97, 100340.18, 100372.5, 100469.9, 100594.97, 100839.79, 100861.37, 100998.42, 101608.22, 101608.22, 101608.22, 101608.22, 101496.22, 101496.22, 100663.42, 100729.76, 100588.77];
const equityLabelsDaily = ["2025-09-27", "2025-09-29", "2025-09-30"];
const equityValuesDaily = [100127.3, 101496.22, 100588.77];
const symbolHistory = {"ANIP": {"t": ["2025-09-27T22:42:31Z", "2025-09-27T22:48:55Z", "2025-09-27T22:54:02Z", "2025-09-27T23:13:33Z", "2025-09-29T13:22:41Z", "2025-09-29T13:42:54Z", "2025-09-29T13:52:04Z", "2025-09-29T13:58:22Z", "2025-09-29T14:15:58Z", "2025-09-29T14:35:04Z", "2025-09-29T14:45:47Z", "2025-09-29T14:51:51Z", "2025-09-29T14:57:50Z", "2025-09-29T15:14:50Z", "2025-09-29T15:31:35Z", "2025-09-29T15:42:02Z", "2025-09-29T15:48:15Z", "2025-09-29T15:55:15Z", "2025-09-29T16:09:17Z", "2025-09-29T16:29:07Z", "2025-09-29T16:38:10Z", "2025-09-29T16:44:35Z", "2025-09-29T16:50:18Z", "2025-09-29T16:56:35Z", "2025-09-29T17:11:20Z", "2025-09-29T17:28:41Z", "2025-09-29T17:36:34Z", "2025-09-29T17:42:51Z", "2025-09-29T17:49:06Z", "2025-09-29T17:54:41Z", "2025-09-29T18:00:21Z", "2025-09-29T18:29:13Z", "2025-09-29T18:48:08Z", "2025-09-29T18:55:32Z", "2025-09-29T19:07:53Z", "2025-09-29T19:22:52Z", "2025-09-29T19:28:33Z", "2025-09-29T19:36:20Z", "2025-09-29T19:43:07Z", "2025-09-29T19:49:20Z", "2025-09-29T19:55:37Z", "2025-09-29T20:11:07Z", "2025-09-29T20:26:49Z", "2025-09-29T20:35:38Z", "2025-09-29T20:43:07Z", "2025-09-29T20:49:12Z", "2025-09-29T20:54:44Z", "2025-09-29T21:00:12Z", "2025-09-30T13:22:20Z", "2025-09-30T13:42:35Z", "2025-09-30T13:52:14Z"], "price": [93.05, 93.05, 93.05, 93.05, 94.51, 92.5, 92.31, 92.54, 92.63, 92.73, 92.63, 92.25, 92.32, 92.18, 91.96, 91.94, 92.02, 91.39, 91.45, 91.22, 91.27, 91.58, 91.58, 91.49, 91.6, 91.58, 91.66, 91.69, 91.62, 91.68, 91.52, 91.15, 91.28, 90.89, 90.95, 90.73, 90.87, 91.31, 91.39, 91.82, 92.2, 91.93, 91.93, 91.93, 91.93, 91.93, 91.93, 91.93, 91.93, 91.93, 92.51], "plpc": [-2.1042, -2.1042, -2.1042, -2.1042, -0.5681, -2.6828000000000003, -2.8827, -2.6407, -2.546, -2.4408, -2.546, -2.9458, -2.8722000000000003, -3.0195, -3.2509, -3.272, -3.1877999999999997, -3.8506, -3.7875, -4.0347, -3.9768999999999997, -3.656, -3.6506999999999996, -3.7454, -3.6297, -3.6506999999999996, -3.5718, -3.535, -3.6086, -3.5455, -3.7137999999999995, -4.1030999999999995, -3.9662999999999995, -4.3766, -4.3135, -4.545, -4.3977, -3.9348, -3.8506, -3.3981999999999997, -2.9984, -3.2825, -3.2825, -3.2825, -3.2825, -3.2825, -3.2825, -3.2825, -3.2825, -3.2775, -2.6723]}, "APH": {"t": ["2025-09-27T22:42:31Z", "2025-09-27T22:48:55Z", "2025-09-27T22:54:02Z", "2025-09-27T23:13:33Z", "2025-09-29T13:22:41Z", "2025-09-29T13:42:54Z", "2025-09-29T13:52:04Z", "2025-09-29T13:58:22Z", "2025-09-29T14:15:58Z", "2025-09-29T14:35:04Z", "2025-09-29T14:45:47Z", "2025-09-29T14:51:51Z", "2025-09-29T14:57:50Z", "2025-09-29T15:14:50Z", "2025-09-29T15:31:35Z", "2025-09-29T15:42:02Z", "2025-09-29T15:48:15Z", "2025-09-29T15:55:15Z", "2025-09-29T16:09:17Z", "2025-09-29T16:29:07Z", "2025-09-29T16:38:10Z", "2025-09-29T16:44:35Z", "2025-09-29T16:50:18Z", "2025-09-29T16:56:35Z", "2025-09-29T17:11:20Z", "2025-09-29T17:28:41Z", "2025-09-29T17:36:34Z", "2025-09-29T17:42:51Z", "2025-09-29T17:49:06Z", "2025-09-29T17:54:41Z", "2025-09-29T18:00:21Z", "2025-09-29T18:29:13Z", "2025-09-29T18:48:08Z", "2025-09-29T18:55:32Z", "2025-09-29T19:07:53Z", "2025-09-29T19:22:52Z", "2025-09-29T19:28:33Z", "2025-09-29T19:36:20Z", "2025-09-29T19:43:07Z", "2025-09-29T19:49:20Z", "2025-09-29T19:55:37Z", "2025-09-29T20:11:07Z", "2025-09-29T20:26:49Z", "2025-09-29T20:35:38Z", "2025-09-29T20:43:07Z", "2025-09-29T20:49:12Z", "2025-09-29T20:54:44Z", "2025-09-29T21:00:12Z", "2025-09-30T13:22:20Z", "2025-09-30T13:42:35Z", "2025-09-30T13:52:14Z"], "price": [122.6, 122.6, 122.6, 122.6, 123.77, 123.76, 122.92, 122.72, 120.94, 121.69, 121.5, 121.68, 121.61, 121.8, 121.47, 121.25, 121.35, 121.53, 121.36, 121.57, 121.51, 121.26, 121.15, 121.25, 121.2, 121.03, 121.08, 120.97, 120.95, 120.98, 120.81, 120.55, 120.61, 120.52, 120.41, 120.62, 120.63, 120.77, 120.86, 120.72, 120.76, 121.01, 121.2, 121.2, 121.2, 121.2, 121.2, 121.2, 121.24, 122.94, 122.7], "plpc": [-0.43039999999999995, -0.43039999999999995, -0.43039999999999995, -0.43039999999999995, 0.5198, 0.5117, -0.1665, -0.333, -1.7745, -1.1695, -1.3197, -1.1776, -1.2345, -1.0802, -1.3481999999999998, -1.5268, -1.4456, -1.2994, -1.4375, -1.2670000000000001, -1.3157, -1.5187000000000002, -1.6081, -1.5268, -1.5715, -1.7055, -1.6608, -1.7541999999999998, -1.7680999999999998, -1.7421, -1.8842, -2.0953, -2.0501, -2.1197, -2.2089999999999996, -2.0426, -2.0282999999999998, -1.9167, -1.8436000000000001, -1.9532, -1.9268, -1.7218, -1.5649, -1.5649, -1.5649, -1.5649, -1.5649, -1.5649, -1.5350000000000001, -0.15839999999999999, -0.3533]}, "CENX": {"t": ["2025-09-27T22:42:31Z", "2025-09-27T22:48:55Z", "2025-09-27T22:54:02Z", "2025-09-27T23:13:33Z", "2025-09-29T13:22:41Z", "2025-09-29T13:42:54Z", "2025-09-29T13:52:04Z", "2025-09-29T13:58:22Z", "2025-09-29T14:15:58Z", "2025-09-29T14:35:04Z", "2025-09-29T14:45:47Z", "2025-09-29T14:51:51Z", "2025-09-29T14:57:50Z", "2025-09-29T15:14:50Z", "2025-09-29T15:31:35Z", "2025-09-29T15:42:02Z", "2025-09-29T15:48:15Z", "2025-09-29T15:55:15Z", "2025-09-29T16:09:17Z", "2025-09-29T16:29:07Z", "2025-09-29T16:38:10Z", "2025-09-29T16:44:35Z", "2025-09-29T16:50:18Z", "2025-09-29T16:56:35Z", "2025-09-29T17:11:20Z", "2025-09-29T17:28:41Z", "2025-09-29T17:36:34Z", "2025-09-29T17:42:51Z", "2025-09-29T17:49:06Z", "2025-09-29T17:54:41Z", "2025-09-29T18:00:21Z", "2025-09-29T18:29:13Z", "2025-09-29T18:48:08Z", "2025-09-29T18:55:32Z", "2025-09-29T19:07:53Z", "2025-09-29T19:22:52Z", "2025-09-29T19:28:33Z", "2025-09-29T19:36:20Z", "2025-09-29T19:43:07Z", "2025-09-29T19:49:20Z", "2025-09-29T19:55:37Z", "2025-09-29T20:11:07Z", "2025-09-29T20:26:49Z", "2025-09-29T20:35:38Z", "2025-09-29T20:43:07Z", "2025-09-29T20:49:12Z", "2025-09-29T20:54:44Z", "2025-09-29T21:00:12Z", "2025-09-30T13:22:20Z", "2025-09-30T13:42:35Z", "2025-09-30T13:52:14Z"], "price": [27.99, 27.99, 27.99, 27.99, 28.85, 29.8, 29.7, 29.62, 29.35, 29.93, 29.72, 29.81, 29.82, 29.48, 29.87, 29.63, 29.69, 29.54, 29.41, 29.46, 29.44, 29.44, 29.53, 29.47, 29.49, 29.35, 29.43, 29.41, 29.39, 29.51, 29.47, 29.3, 29.32, 29.28, 29.34, 29.36, 29.34, 29.26, 29.39, 29.5, 29.39, 29.4, 29.99, 29.99, 29.99, 29.99, 29.87, 29.87, 29.18, 29.09, 28.92], "plpc": [7.364800000000001, 7.364800000000001, 7.364800000000001, 7.364800000000001, 10.663599999999999, 14.3076, 13.943200000000001, 13.617199999999999, 12.581500000000002, 14.8063, 14.0027, 14.346, 14.3843, 13.0848, 14.5761, 13.655500000000002, 13.8857, 13.3103, 12.8117, 12.9843, 12.926699999999999, 12.917100000000001, 13.272, 13.0418, 13.1185, 12.581500000000002, 12.8884, 12.815499999999998, 12.7349, 13.195200000000002, 13.0418, 12.3897, 12.4664, 12.313, 12.556600000000001, 12.619900000000001, 12.5623, 12.2363, 12.7349, 13.176099999999998, 12.7349, 12.7541, 15.0364, 15.0364, 15.0364, 15.0364, 14.588400000000002, 14.588400000000002, 11.9294, 11.5842, 10.9321]}, "EAT": {"t": ["2025-09-27T22:42:31Z", "2025-09-27T22:48:55Z", "2025-09-27T22:54:02Z", "2025-09-27T23:13:33Z", "2025-09-29T13:22:41Z", "2025-09-29T13:42:54Z", "2025-09-29T13:52:04Z", "2025-09-29T13:58:22Z", "2025-09-29T14:15:58Z", "2025-09-29T14:35:04Z", "2025-09-29T14:45:47Z", "2025-09-29T14:51:51Z", "2025-09-29T14:57:50Z", "2025-09-29T15:14:50Z", "2025-09-29T15:31:35Z", "2025-09-29T15:42:02Z", "2025-09-29T15:48:15Z", "2025-09-29T15:55:15Z", "2025-09-29T16:09:17Z", "2025-09-29T16:29:07Z", "2025-09-29T16:38:10Z", "2025-09-29T16:44:35Z", "2025-09-29T16:50:18Z", "2025-09-29T16:56:35Z", "2025-09-29T17:11:20Z", "2025-09-29T17:28:41Z", "2025-09-29T17:36:34Z", "2025-09-29T17:42:51Z", "2025-09-29T17:49:06Z", "2025-09-29T17:54:41Z", "2025-09-29T18:00:21Z", "2025-09-29T18:29:13Z", "2025-09-29T18:48:08Z", "2025-09-29T18:55:32Z", "2025-09-29T19:07:53Z", "2025-09-29T19:22:52Z", "2025-09-29T19:28:33Z", "2025-09-29T19:36:20Z", "2025-09-29T19:43:07Z", "2025-09-29T19:49:20Z", "2025-09-29T19:55:37Z", "2025-09-29T20:11:07Z", "2025-09-29T20:26:49Z", "2025-09-29T20:35:38Z", "2025-09-29T20:43:07Z", "2025-09-29T20:49:12Z", "2025-09-29T20:54:44Z", "2025-09-29T21:00:12Z", "2025-09-30T13:22:20Z", "2025-09-30T13:42:35Z", "2025-09-30T13:52:14Z"], "price": [132.19, 132.19, 132.19, 132.19, 132.19, 131.83, 132.14, 131.97, 131.98, 130.93, 130.83, 130.48, 130.52, 131.22, 131.13, 131.48, 131.31, 131.2, 130.79, 130.56, 130.3, 130.32, 130.2, 130.26, 130.48, 131.71, 131.78, 131.75, 131.76, 131.65, 131.86, 131.8, 131.72, 131.88, 131.79, 131.7, 131.74, 131.94, 131.72, 131.99, 132.13, 132.97, 132.97, 132.97, 132.97, 132.97, 132.97, 132.97, 132.0, 130.94, 130.49], "plpc": [-4.3210999999999995, -4.3210999999999995, -4.3210999999999995, -4.3210999999999995, -4.3210999999999995, -4.5816, -4.3573, -4.480300000000001, -4.4731, -5.2331, -5.3054, -5.5588, -5.5298, -5.0268, -5.088299999999999, -4.835, -4.958, -5.037599999999999, -5.3344000000000005, -5.500900000000001, -5.6906, -5.6782, -5.7651, -5.718, -5.5588, -4.6685, -4.6142, -4.6395, -4.632300000000001, -4.7119, -4.5599, -4.6034, -4.6575999999999995, -4.5418, -4.6106, -4.6720999999999995, -4.6468, -4.5056, -4.6613, -4.465800000000001, -4.3645000000000005, -3.7565, -3.7565, -3.7565, -3.7565, -3.7565, -3.7565, -3.7565, -4.4586, -5.2294, -5.5516000000000005]}};

const eqCtx = document.getElementById('equityChart').getContext('2d');
let equityMode = 'daily'; // 'daily' o 'intraday'
function buildEquityDataset() {
  if (equityMode === 'daily') {
    return { labels: equityLabelsDaily, data: equityValuesDaily };
  } else {
    return { labels: equityLabelsIntraday, data: equityValuesIntraday };
  }
}
function renderEquity() {
  const ds = buildEquityDataset();
  if (window.eqChart) window.eqChart.destroy();
  window.eqChart = new Chart(eqCtx, {
    type: 'line',
    data: { labels: ds.labels, datasets: [{ label:'Portfolio Value', data: ds.data, borderWidth:2, fill:false, tension:0.25 }] },
    options: {
      responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false} },
      scales:{ y:{ ticks:{ callback:(v)=>'$'+v.toLocaleString() } } }
    }
  });
}
renderEquity();

document.getElementById('equityToggle').addEventListener('click', ()=>{
  equityMode = (equityMode === 'daily') ? 'intraday' : 'daily';
  document.getElementById('equityToggle').textContent = 'Equity: ' + (equityMode === 'daily' ? 'Daily' : 'Intraday');
  renderEquity();
});

// --- Per-symbol chart ---
const symSel = document.getElementById('symSel');
const toggleBtn = document.getElementById('toggleMetric');
let metric = 'plpc'; // 'plpc' (%) o 'price'

const symbols = Object.keys(symbolHistory).sort();
for (const s of symbols) {
  const opt = document.createElement('option');
  opt.value = s; opt.textContent = s;
  symSel.appendChild(opt);
}
if (symbols.length === 0) {
  const opt = document.createElement('option');
  opt.value = ''; opt.textContent = 'No positions';
  symSel.appendChild(opt);
}

const symCtx = document.getElementById('symbolChart').getContext('2d');
let symChart = null;

function renderSymbolChart(sym) {
  if (!sym || !symbolHistory[sym]) return;
  const H = symbolHistory[sym];
  const labels = H.t;
  const data = (metric === 'plpc') ? H.plpc : H.price;
  const label = (metric === 'plpc') ? '% P/L' : 'Price';
  if (symChart) symChart.destroy();
  symChart = new Chart(symCtx, {
    type: 'line',
    data: { labels, datasets: [{ label: sym + ' ' + label, data, borderWidth:2, fill:false, tension:0.25 }] },
    options: {
      responsive:true, maintainAspectRatio:false,
      plugins:{ legend:{display:false} },
      scales:{ y:{ ticks:{ callback:(v)=> metric==='plpc' ? v.toFixed(2)+'%' : '$'+v.toLocaleString() } } }
    }
  });
}

symSel.addEventListener('change', ()=> renderSymbolChart(symSel.value));
toggleBtn.addEventListener('click', ()=>{
  metric = (metric === 'plpc') ? 'price' : 'plpc';
  toggleBtn.textContent = 'Metric: ' + (metric === 'plpc' ? '% P/L' : 'Price');
  renderSymbolChart(symSel.value);
});

if (symbols.length > 0) { symSel.value = symbols[0]; renderSymbolChart(symbols[0]); }
</script>
</body>
</html>
